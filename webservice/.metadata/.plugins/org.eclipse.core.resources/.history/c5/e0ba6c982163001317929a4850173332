package webservice.resource;

import java.util.ArrayList;
import java.util.Iterator;

import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.DELETE;
import javax.ws.rs.PUT;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.Consumes;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.Path;









import webservice.database.DB_Connector;
import webservice.representations.Collection;
import webservice.representations.Comment;
import webservice.representations.Post;
//import webservice.database.DB_Connector;
import webservice.representations.User;

@Path("users")
public class UserResource {
	DB_Connector dbcon = DB_Connector.getInstance();
	
	@GET
	@Produces(MediaType.APPLICATION_JSON)
	public ArrayList<User> getUsers(){
		  dbcon.initDBConnection();
		  ArrayList<User> list = dbcon.getUsers();
		  System.out.println("used method getUsers");
		  return list;
	}
	
	@POST
	@Consumes(MediaType.APPLICATION_JSON)
	public boolean createUser(User user){
		dbcon.initDBConnection();
		System.out.println("used method createUser");
		return dbcon.createUser(user);
	}
	
	
	
	@GET
	@Path("/filter={name}")
	@Produces(MediaType.APPLICATION_JSON)
	public ArrayList<User> getUsersByName(@PathParam("name") String name){
		dbcon.initDBConnection();
		ArrayList<User> list = dbcon.getUsersByName(name);
		System.out.println("used method getUsersByName");
		return list;
	}
	
	@GET
	@Path("/{id}")
	@Produces(MediaType.APPLICATION_JSON)
	public User getSingleUser(@PathParam("id") int id){
		dbcon.initDBConnection();
		User user = dbcon.getSingleUser(id);
		System.out.println("used method getSingleUser");
		return user;
	}
	
	@PUT
	@Path("/{id}")
	@Consumes(MediaType.APPLICATION_JSON)
	public boolean changeUser(User user){
		dbcon.initDBConnection();
		System.out.println("used method changeUser");
		return dbcon.changeUser(user);
	}
	
	@GET
	@Path("/{id}/posts")
	@Produces(MediaType.APPLICATION_JSON)
	public ArrayList<Post> getPostsByUser(@PathParam("id") int id){
		dbcon.initDBConnection();
		ArrayList<Post> list = dbcon.getPostsByUser(id);
		System.out.println("used method getPostsByUser");
		return list;
	}

	@POST
	@Path("/{id}/comments")
	@Consumes(MediaType.APPLICATION_JSON)
	public boolean createComment(@PathParam("id") int id, Comment comment){
		dbcon.initDBConnection();
		comment.setPostID(id);
		System.out.println("used method createComment");
		return dbcon.createComment(comment);
	}
}
