package webservice.security;

import java.util.List;

import javax.ws.rs.WebApplicationException;

import com.sun.jersey.api.core.HttpRequestContext;
import com.sun.jersey.oauth.server.OAuthServerRequest;
import com.sun.jersey.oauth.signature.OAuthParameters;
import com.sun.jersey.oauth.signature.OAuthSecrets;
import com.sun.jersey.oauth.signature.OAuthSignature;
import com.sun.jersey.oauth.signature.OAuthSignatureException;



public class AuthRequestFilter {
	
	public static void verifyOAuth(HttpRequestContext context)  {

        try {
            OAuthServerRequest oauthReq = new OAuthServerRequest(context);

            for (String key : context.getFormParameters().keySet()) {
                List<String> value = context.getFormParameters().get(key);
                System.out.println(key + " -> " + value);
            }
            for (String key : oauthReq.getParameterNames()) {
                List<String> value = oauthReq.getHeaderValues(key);
                System.out.println(key + " -> " + value);
            }

            OAuthParameters params = new OAuthParameters();
            params.readRequest(oauthReq);
            OAuthSecrets secrets = new OAuthSecrets().consumerSecret("CONSUMER_SECRET").tokenSecret("TOKEN_SECRET");
            boolean isValid = OAuthSignature.verify(oauthReq, params, secrets);
            if (!isValid) {
                throw new WebApplicationException(401);
            }
        } catch (OAuthSignatureException e) {
            throw new WebApplicationException(401);
        }
    }
	
}
